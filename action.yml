name: 'Firebolt PR checks'
description: 'Verify PR formatting'
inputs:
  github-key:
    description: 'Github token'
    required: true
runs:
  using: "composite"
  steps:
    - name: Check title name convention
      uses: jef/conventional-commits-pr-action@v1.0.0
      with:
        token: ${{ inputs.github-key }}

    - name: Check PR title
      uses: actions/github-script@v4
      with:
        github-token: ${{ inputs.github-key }}
        script: |
          const payload = context.payload
          const prTitle = payload.pull_request.title
          // The pattern for JIRA ticket format
          const jiraPattern = /FIR-\d+/g
          console.log(prTitle)
          if (!jiraPattern.test(prTitle)) {
            console.log('The PR title does not match JIRA ticket format!')
            // Fails the workflow
            core.setFailed('PR title does not match JIRA ticket format!')
          } else {
            console.log('PR title format is correct.')
          }
